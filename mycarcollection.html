<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Car Collection - Cars Collector</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <main class="container">
        <h1>My Car Collection</h1>
        <p>Browse, manage, and showcase your cars.</p>

        <section id="cars-container">
            <div class="button-group">
                <button id="add-new" onclick="window.location.href='newcar.html'"> Add New Car</button>
                <button id="clear-all" class="danger"> Clear All</button>
            </div>
            <div id="cars-list"></div>
        </section>

        <button type="button" class="nav-button secondary" onclick="window.location.href='mainpage.html'">← Back to Home</button>
    </main>
    <script>
        (function(){
            function loadCars(){
                try{
                    return JSON.parse(localStorage.getItem('cars')||'[]');
                }catch(e){
                    return [];
                }
            }
            function saveCars(cars){
                localStorage.setItem('cars', JSON.stringify(cars));
            }
            function render(){
                const list = document.getElementById('cars-list');
                const cars = loadCars();
                list.innerHTML = '';
                if(!cars || cars.length === 0){
                    list.innerHTML = '<div class="empty-state"><p> No cars yet</p><p style="font-size:0.95rem;">Add your first car to get started!</p></div>';
                    return;
                }
                const count = document.createElement('p');
                count.style.marginBottom = '20px';
                count.style.color = '#718096';
                count.textContent = `You have ${cars.length} car${cars.length !== 1 ? 's' : ''} in your collection`;
                list.appendChild(count);
                cars.forEach(car => {
                    const card = document.createElement('div');
                    card.className = 'car-card';
                    const title = document.createElement('h3');
                    title.textContent = car.make || 'Unnamed car';
                    card.appendChild(title);
                    const info = document.createElement('div');
                    info.className = 'car-info';
                    let details = [];
                    if(car.year) details.push('Year: ' + car.year);
                    if(car.color) details.push('Color: ' + car.color);
                    if(car.createdAt) details.push('Added: ' + car.createdAt);
                    info.textContent = details.join(' • ');
                    card.appendChild(info);
                    if(car.image){
                        const img = document.createElement('img');
                        img.src = car.image;
                        img.alt = car.make || '';
                        img.className = 'car-image';
                        img.onerror = function(){ this.style.display = 'none'; };
                        card.appendChild(img);
                    }
                    const del = document.createElement('button');
                    del.className = 'danger';
                    del.textContent = 'Delete';
                    del.style.alignSelf = 'flex-start';
                    del.addEventListener('click', function(){
                        if(confirm('Remove this car from your collection?')){
                            const remaining = loadCars().filter(c => c.id !== car.id);
                            saveCars(remaining);
                            render();
                        }
                    });
                    card.appendChild(del);
                    list.appendChild(card);
                });
            }
            document.getElementById('clear-all').addEventListener('click', function(){
                if(confirm('Remove all cars from your collection? This cannot be undone.')){
                    localStorage.removeItem('cars');
                    render();
                }
            });
            render();
        })();
    </script>
</body>
</html>